# 测试执行器使用说明

## 概述

测试执行器是一个基于智能登录的自动化测试框架，支持：
- 自动登录系统（智能识别验证码）
- 执行所有测试用例
- 执行指定测试用例
- 按模块执行测试用例

## 功能特点

### 1. 智能登录
- 自动分析登录页面结构
- 自动填写用户名和密码
- 等待手动输入验证码（5秒循环重试）
- 自动判断登录成功/失败

### 2. 灵活的执行方式
- **全量执行**：执行所有测试用例
- **指定执行**：执行指定的测试用例ID
- **模块执行**：执行指定模块的测试用例

### 3. 详细的测试报告
- 测试执行结果统计
- 成功率计算
- 详细的执行日志
- JSON格式报告保存

## 使用方法

### 1. 执行所有测试用例
```bash
python scripts/python/test_runner.py --all
```

### 2. 执行指定的测试用例
```bash
python scripts/python/test_runner.py --test-cases TC_1_1_1 TC_1_1_2
```

### 3. 按模块执行测试用例
```bash
python scripts/python/test_runner.py --module 用户管理
```

### 4. 查看帮助信息
```bash
python scripts/python/test_runner.py --help
```

## 工作流程

### 1. 登录阶段
```
步骤1: 登录系统...
- 分析登录页面结构
- 自动填写用户名和密码
- 等待手动输入验证码（5秒循环）
- 自动判断登录结果
```

### 2. 测试执行阶段
```
步骤2: 执行测试用例...
- 根据测试用例类型选择执行方法
- 执行具体的测试逻辑
- 记录执行结果和时间
```

### 3. 报告生成阶段
```
步骤3: 生成测试报告...
- 统计测试结果
- 计算成功率
- 保存详细报告
```

## 测试用例分类

### 1. 用户管理模块
- **TC_1_1_1**: 用户录入测试
- **TC_1_1_2**: 用户查询测试

### 2. 系统管理模块
- **TC_2_1_1**: 系统配置测试
- **TC_2_1_2**: 系统监控测试

### 3. 权限管理模块
- **TC_3_1_1**: 权限分配测试

## 输出文件

### 1. 登录分析结果
- 位置：`results/login_analysis_YYYYMMDD_HHMMSS.json`
- 内容：登录页面元素分析结果

### 2. 测试报告
- 位置：`results/test_report_YYYYMMDD_HHMMSS.json`
- 内容：测试执行结果和统计信息

### 3. 页面截图
- 位置：`results/page_analysis_*.png`
- 内容：页面分析截图

## 配置说明

### 1. 登录配置
在 `config/settings.yaml` 中配置：
```yaml
url: http://192.168.24.100
username: super
password: admin123
```

### 2. 测试用例配置
在测试执行器中配置模块和测试用例的映射关系。

## 扩展说明

### 1. 添加新的测试用例
1. 在 `_execute_single_test_case` 方法中添加新的测试类型判断
2. 实现对应的测试执行方法
3. 更新模块测试用例映射

### 2. 添加新的模块
1. 在 `_get_test_cases_by_module` 方法中添加新模块
2. 实现模块对应的测试执行方法
3. 更新测试用例分类

## 故障排除

### 1. 登录失败
- 检查网络连接
- 确认用户名密码正确
- 手动输入验证码

### 2. 测试用例执行失败
- 检查登录状态
- 确认页面元素存在
- 查看详细错误日志

### 3. 浏览器相关问题
- 确保Playwright已正确安装
- 检查浏览器驱动
- 重启测试执行器

## 最佳实践

### 1. 测试用例设计
- 每个测试用例应该独立
- 测试用例之间不应该有依赖关系
- 测试用例应该可以重复执行

### 2. 执行策略
- 开发阶段：执行单个测试用例
- 集成测试：执行模块测试
- 回归测试：执行所有测试用例

### 3. 报告分析
- 关注失败率较高的测试用例
- 分析执行时间较长的测试用例
- 定期清理旧的测试报告

## 技术架构

### 1. 分层设计
- **配置层**：ConfigLoader
- **登录层**：SmartLogin
- **执行层**：TestRunner
- **报告层**：TestReport

### 2. 模块化设计
- 登录模块独立
- 测试执行模块独立
- 报告生成模块独立

### 3. 可扩展性
- 支持新的测试类型
- 支持新的模块
- 支持新的报告格式 